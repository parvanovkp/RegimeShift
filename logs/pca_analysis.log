2024-09-29 02:39:04,453 - INFO - Loaded preprocessed data from preprocessed_data/preprocessed_stocks.csv with shape (5462, 457)
2024-09-29 02:39:04,519 - INFO - Loaded preprocessed data from preprocessed_data/preprocessed_etfs.csv with shape (5462, 20)
2024-09-29 02:39:04,523 - INFO - Saved sector mapping to sector_mapping.csv
2024-09-29 02:39:04,523 - INFO - Performing full period PCA
2024-09-29 02:39:04,569 - INFO - Full period PCA completed. Explained variance ratio: [0.2452253  0.07449605 0.02787422 0.01953254 0.01677795 0.01509389
 0.01217078 0.01110908 0.01070577 0.0095404  0.00902069 0.0083807
 0.00776329 0.00727506 0.00705589 0.00688922 0.00654904 0.00623185
 0.00583989 0.00545876 0.00522237 0.00513634 0.00505094 0.00482579
 0.00463157 0.00454483 0.00437566 0.00434869 0.00409028 0.0039537
 0.00380748 0.00375578 0.00353642 0.00345739 0.00336425 0.00329402
 0.00322588 0.00318917 0.00316882 0.00310208 0.00298469 0.00293056
 0.0029064  0.00284796 0.00280709 0.00276608 0.00270164 0.00269176
 0.00264836 0.00261734 0.00260434 0.00253553 0.00251065 0.00244628
 0.00243678 0.00242051 0.00239791 0.00236032 0.00233944 0.00232153
 0.00227757 0.00226307 0.0022614  0.00224441 0.00219324 0.00218877
 0.00216561 0.00212885 0.00212072 0.00210172 0.00208544 0.00207615
 0.00205696 0.0020369  0.00201766 0.00201514 0.00199172 0.00197064
 0.00195252 0.00194194 0.00192949 0.00192003 0.0019021  0.00189561
 0.00188532 0.00187235 0.00183835 0.00182357 0.00181468 0.00180513
 0.00179242 0.00176713 0.00176209 0.00174096 0.00173115 0.00173053
 0.00172225 0.0017072  0.00170177 0.00168629 0.00167199 0.00165093
 0.00164532 0.00163161 0.00162567 0.00160823 0.00159198 0.00158886
 0.00158071 0.00156824 0.00156173 0.00154505 0.0015322  0.00152706
 0.00151919 0.00150826 0.00149381 0.00148967 0.00148068 0.00147154
 0.00146402 0.00146183 0.00144695 0.00143677 0.00143547 0.00142282
 0.00141939 0.00141704 0.00140564 0.00140099 0.00139813 0.0013843
 0.00138084 0.00137633 0.00136811 0.00135624 0.00134617 0.0013376
 0.00133324 0.00132614 0.00131957 0.00131498 0.00130454 0.0012998
 0.00128648 0.00128294 0.00127509 0.00127305 0.00126799 0.00126407
 0.00125865 0.00125334 0.00124463 0.00123894 0.00123276 0.00122822
 0.0012193  0.0012174  0.00120858 0.00120167 0.00119458 0.00118775
 0.00118227 0.00117428 0.00117023 0.0011645  0.00115892 0.00115439
 0.0011509  0.00114799 0.00114242 0.00113886 0.00113054 0.00112251
 0.00111647 0.00111387 0.00111048 0.00110145 0.00110012 0.00109711
 0.00108711 0.00108042 0.00107585 0.00107087 0.00106701 0.001061
 0.00105769 0.00105459 0.00104857 0.00104376 0.00103754 0.00103389
 0.00103132 0.00102511 0.00102345 0.00101472 0.00101368 0.00101183
 0.00100391 0.00100113 0.00099834 0.00099235 0.00098892 0.00098807
 0.00098202 0.00097778 0.0009706  0.00096829 0.0009627  0.00095416
 0.00095395 0.00094963 0.00094443 0.00093819 0.00093488 0.00092792
 0.00092467 0.00091915 0.00091466 0.00091165 0.00090603 0.00090256
 0.00089949 0.00089506 0.00089202 0.0008861  0.00088312 0.00087641
 0.00087494 0.0008722  0.00086354 0.00086331 0.00086078 0.00085708
 0.00085208 0.00084904 0.00084529 0.0008437  0.00083977 0.00083727
 0.00082979 0.00082823 0.000824   0.00082264 0.00081922 0.00081335
 0.00081039 0.00080744 0.00080473 0.00079732 0.00079569 0.00079211
 0.0007902  0.00078587 0.00078138]
2024-09-29 02:39:04,805 - INFO - Saved PCA components to pca_components.csv
2024-09-29 02:39:04,805 - INFO - Performing rolling window PCA with window size 1950 and step size 195
2024-09-29 02:39:06,834 - INFO - Rolling window PCA completed
2024-09-29 02:39:11,613 - INFO - Saved rolling window PCA results to rolling_window_pca_results.csv
2024-09-29 02:39:11,613 - INFO - Max components: 228, Max features: 457
2024-09-29 02:40:21,924 - INFO - Saved Sparse PCA components to sparse_pca_components.csv
2024-09-29 02:40:22,024 - INFO - Performing sector-based PCA
2024-09-29 02:40:22,046 - INFO - Sector-based PCA completed
2024-09-29 02:40:22,212 - INFO - PCA analysis completed successfully
